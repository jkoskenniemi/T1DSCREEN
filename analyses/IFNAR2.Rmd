---
  title: "IFNAR2"
author: "Tea Heikkil√§, Emilia Kaiser & Jaakko Koskenniemi"
output: html_document
date: '2022-26-04'
editor_options:
  chunk_output_type: console
---

  Load packages and import data
```{r}
pacman::p_load(tidyverse, data.table, coloc,TwoSampleMR, ggpubr,
               ieugwasr, rio, here)

source("code/Functions.R")

here::i_am("analyses/IFNAR2.Rmd")
```

# eQTL

```{r}
IFNAR2_eqtl <- import_data("data/export/IFNAR2_eqtl_TwoSampleMR.csv",
                           "data/export/IFNAR2_T1D_TwoSampleMR.csv",
                           has_beta = FALSE)

```

## Initial Manhattan plots
```{r}
manhattan_plots(IFNAR2_eqtl, gene_start=33205282, gene_end=33265675, title = "IFNAR2")
IFNAR2_eqtl <- IFNAR2_eqtl %>% filter(pos.outcome > 33000000 & pos.outcome < 33500000) 
manhattan_plots(IFNAR2_eqtl, gene_start=33205282, gene_end=33265675, title = "IFNAR2")
```

## Coloc assuming 1 causal variant
```{r}
coloc_results_IFNAR2_eqtl <- analyze_coloc_eqtl(IFNAR2_eqtl)
# coloc_results_IFNAR2_eqtl$coloc_D1D2 #coloc results
# coloc_results_IFNAR2_eqtl$D1 #data eQTL
# coloc_results_IFNAR2_eqtl$D2 #data t1d

#ggsave(filename = "figures/IFNAR2_coloc.png", height = 8, width = 6)

```

## Regional manhattan plot

```{r}

load("data/export/IFNAR2_LDmat.RData")

plot_coloc(genechr = 21,
           fig_start = 33000000,
           fig_end = 33500000,
           coloc_results = coloc_results_IFNAR2_eqtl$coloc_D1D2,
           data = IFNAR2_eqtl,
           D1 = coloc_results_IFNAR2_eqtl$D1,
           D2 = coloc_results_IFNAR2_eqtl$D2,
           LDmat = IFNAR2)

ggsave(filename = "figures/IFNAR2.png", height = 8, width = 6)
```





