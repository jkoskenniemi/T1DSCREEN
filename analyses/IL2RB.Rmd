---
title: "IL2RB"
author: "Tea Heikkil√§, Emilia Kaiser & Jaakko Koskenniemi"
output:
  html_document:
    toc: yes
    toc_float: yes
    number_sections: yes
    code_folding: hide
date: '2022-04-05'
editor_options: 
  chunk_output_type: console
---

Load packages and import data
```{r}
pacman::p_load(tidyverse, data.table, coloc,TwoSampleMR, ggpubr, 
               ieugwasr, rio, here)

here::i_am("analyses/IL2RB.Rmd")

source("code/Functions.R")
```


# eQTL


```{r}

IL2RB_eqtl <- import_data("data/export/IL2RB_eqtl_TwoSampleMR.csv",
            "data/export/IL2RB_T1D_TwoSampleMR.csv", has_beta = FALSE)

```

## Manhattan plots
```{r}
#create Manhattan plots with vertical lines indicating the selected area (see below 2.4)
manhattan_plots(IL2RB_eqtl, gene_start=37521878, gene_end=37571094, title = "IL2RB")

ggsave("figures/IL2RB-eQTL-T1D-manhattan.png", height = 6, width = 6)

```

## Coloc assuming 1 causal variant
```{r}
analyze_coloc_eqtl(IL2RB_eqtl)

png("figures/IL2RB-eQTL-T1D-coloc.png", height = 6, width = 8)
dev.off()
```


# pQTL

```{r}
IL2RB_pqtl <- import_data("data/export/IL2RB_prot_anno_TwoSampleMR.csv",
            "data/export/IL2RB_T1D_TwoSampleMR.csv", has_beta = FALSE)

```


## Manhattan plots
```{r}
manhattan_plots(IL2RB_pqtl, gene_start=37521878, gene_end=37571094, title = "IL2RB")

ggsave("figures/IL2RB_pqtl-manhattan-fig.png",
       height = 6, width = 6, units = "in")
```

## Coloc assuming 1 causal variant
```{r}
analyze_coloc_pqtl(IL2RB_pqtl)

```



