---
title: "IL2RG"
author: "Tea Heikkil√§, Emilia Kaiser & Jaakko Koskenniemi"
output:
  html_document:
    toc: yes
    toc_float: yes
    number_sections: yes
    code_folding: hide
date: '2022-04-05'
editor_options: 
  chunk_output_type: console
---

Load packages and import data
```{r}
 pacman::p_load(tidyverse, data.table, coloc,TwoSampleMR, ggpubr, 
                ieugwasr, rio, here)
 
 here::i_am("analyses/IL2RG.Rmd")
 
 source("code/Functions.R")
```


# eQTL


```{r}

IL2RG_eqtl <- import_data("data/export/IL2RG_eqtl_TwoSampleMR.csv",
             "data/export/IL2RG_T1D_TwoSampleMR.csv", has_beta = FALSE)

```
## Initial Manhattan plots
```{r}
manhattan_plots(IL2RG_eqtl, gene_start=71107404, gene_end=71112108, title = "IL2RG")
IL2RG_eqtl <- IL2RG_eqtl %>% filter(pos.outcome > 33600000 & pos.outcome < 34000000) 
manhattan_plots(IL2RG_eqtl, gene_start=71107404, gene_end=71112108, title = "IL2RG")
```

## Coloc assuming 1 causal variant
```{r}
coloc_results_IL2RG_eqtl <- analyze_coloc_eqtl(IL2RG_eqtl)
# coloc_results_IL2RG_eqtl$coloc_D1D2 #coloc results
# coloc_results_IL2RG_eqtl$D1 #data eQTL
# coloc_results_IL2RG_eqtl$D2 #data t1d

```



# pQTL

```{r}
# IL2RG_pqtl <- import_data("data/export/IL2RG_prot_anno_TwoSampleMR.csv",
#             "data/export/IL2RG_T1D_TwoSampleMR.csv", has_beta = FALSE)

```


## Manhattan plots
```{r}
# manhattan_plots(IL2RG_pqtl, gene_start=71107404, 
#                 gene_end=71111577, title = "IL2RG")

# ggsave("figures/IL2RG_pqtl-manhattan-combined-fig.pdf", 
#        height = 6, width = 8, units = "in")
```

## Coloc assuming 1 causal variant
```{r}
# analyze_coloc_pqtl(IL2RG_pqtl)
# pdf("figures/IL2RG-eQTL-T1D-coloc.pdf", height = 6, width = 8)
# dev.off()
```



