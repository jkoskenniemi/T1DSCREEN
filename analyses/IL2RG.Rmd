---
title: "IL2RG"
author: "Tea Heikkil√§, Emilia Kaiser & Jaakko Koskenniemi"
output: html_document
date: '2022-24-05'
editor_options:
  chunk_output_type: console
---

  Load packages and import data
```{r}
library(tidyverse)
library(data.table)
library(coloc)
library(TwoSampleMR)
library(ggpubr)
library(ieugwasr)
library(rio)
library(here)

here::i_am("analyses/IL2RG.Rmd")


IL2RG_prot <- read_exposure_data("data/export/IL2RG_prot_anno_TwoSampleMR.csv", sep=",")
IL2RG_T1D  <- read_outcome_data("data/export/IL2RG_T1D_TwoSampleMR.csv", sep=",")

IL2RG <- harmonise_data(IL2RG_prot, IL2RG_T1D)

```

## Manhattan plots

There were no hits in neither serum IL2RG levels nor risk of T1D in this area 
```{r}
#create Manhattan plots with vertical lines indicating the selected area (see below 2.4)
IL2RG_prot.fig <-
  IL2RG %>%
  ggplot(aes(x = pos.exposure/1000, y=-log10(pval.exposure))) +
  geom_point()+
  geom_hline(yintercept=8, linetype="dashed")+
  # geom_vline(xintercept=36.9e6/1000, linetype="dashed")+
  # geom_vline(xintercept=37.3e6/1000, linetype="dashed")+
  ggtitle("GWAS of IL2RG in serum") +
  ylab("-log10(p)") +
  xlab(NULL)

IL2RG_T1D.fig <-
  IL2RG %>%
  ggplot()+
  geom_point(mapping=aes(x = pos.exposure/1000, y=-log10(pval.outcome))) +
  geom_hline(yintercept=8, linetype="dashed")+
  # geom_vline(xintercept=36.9e6/1000, linetype="dashed")+
  # geom_vline(xintercept=37.3e6/1000, linetype="dashed")+
  ggtitle("GWAS of risk of T1D") +
  ylab("-log10(p)") +
  xlab("position(kbp)")

#Obtain range for figure of gene
layer_scales(IL2RG_T1D.fig)$x$range$range

IL2RG_gene.fig <-
  ggplot(data = IL2RG) +
  geom_blank() +
  geom_segment(x=37521.878, xend=37571.094, y=1, yend=1, linewidth = 2) +
  annotate("text", label = "IL2RG",
           x= (37521.878 + 37571.094) / 2, y=1, hjust = 0.5, vjust = -1) +
  xlim(36521.878, 38571.094) +
  ylim(0.75, 2) +
  ylab(NULL) + xlab(NULL) +
  theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank())

fig_IL2RG_manhattan <- ggarrange(IL2RG_gene.fig, IL2RG_prot.fig, IL2RG_T1D.fig,
                                 heights = c(1, 3, 3), nrow = 3,
                                 ncol = 1, align = "hv")

fig_IL2RG_manhattan 
# ggsave("figures/IL2RG-manhattan-combined-fig.pdf",
#        height = 6, width = 8, units = "in")
```


