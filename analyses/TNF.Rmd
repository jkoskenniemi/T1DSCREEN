---
title: "TNF"
author: "Tea Heikkil√§, Emilia Kaiser & Jaakko Koskenniemi"
output: html_document
date: '2022-24-05'
editor_options:
  chunk_output_type: console
---

  Load packages and import data
```{r}
library(tidyverse)
library(data.table)
library(coloc)
library(TwoSampleMR)
library(ggpubr)
library(ieugwasr)
library(rio)
library(here)

here::i_am("analyses/TNF.Rmd")


TNF_prot <- read_exposure_data("data/export/TNF_prot_anno_TwoSampleMR.csv", sep=",")
TNF_T1D  <- read_outcome_data("data/export/TNF_T1D_TwoSampleMR.csv", sep=",")

TNF <- harmonise_data(TNF_prot, TNF_T1D)

```

## Manhattan plots

There were no GWAS hits near TNF gene for TNF levels in serum. Coloc & MR is not attempted

```{r, echo = FALSE}
#create Manhattan plots with vertical lines indicating the selected area (see below 2.4)
TNF_prot.fig <-
  TNF %>%
  ggplot(aes(x = pos.exposure/1000, y=-log10(pval.exposure))) +
  geom_point()+
  geom_hline(yintercept=8, linetype="dashed")+
  # geom_vline(xintercept=5.9e3, linetype="dashed") +
  # geom_vline(xintercept=6.25e3, linetype="dashed") +
  ggtitle("GWAS of TNF in serum") +
  ylab("-log10(p)") +
  xlab(NULL)

TNF_T1D.fig <-
  TNF %>%
  ggplot()+
  geom_point(mapping=aes(x = pos.exposure/1000, y=-log10(pval.outcome))) +
  geom_hline(yintercept=8, linetype="dashed") +
  # geom_vline(xintercept=5.9e3, linetype="dashed") +
  # geom_vline(xintercept=6.25e3, linetype="dashed") +
  ggtitle("GWAS of risk of T1D") +
  ylab("-log10(p)") +
  xlab("position(kbp)")

#Obtain range for figure of gene
layer_scales(TNF_T1D.fig)$x$range$range

TNF_gene.fig <-
  ggplot(data = TNF) +
  geom_blank() +
  geom_segment(x=37521.878, xend=37571.094, y=1, yend=1, linewidth = 2) +
  annotate("text", label = "TNF",
           x= (37521.878 + 37571.094) / 2, y=1, hjust = 0.5, vjust = -1) +
  xlim(36521.878, 38571.094) +
  ylim(0.75, 2) +
  ylab(NULL) + xlab(NULL) +
  theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank())

fig_TNF_manhattan <- ggarrange(TNF_gene.fig, TNF_prot.fig, TNF_T1D.fig,
                                 heights = c(1, 3, 3), nrow = 3,
                                 ncol = 1, align = "hv")
fig_TNF_manhattan
# ggsave("figures/TNF-manhattan-combined-fig.pdf",
#        height = 6, width = 8, units = "in")
```
