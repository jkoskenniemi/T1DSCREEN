---
title: "TYK2"
author: "Tea Heikkil√§, Emilia Kaiser & Jaakko Koskenniemi"
output: html_document
date: '2022-26-04'
editor_options:
  chunk_output_type: console
---

  Load packages and import data
```{r}
library(tidyverse)
library(data.table)
library(coloc)
library(TwoSampleMR)
library(ggpubr)
library(ieugwasr)
library(rio)
library(here)

here::i_am("analyses/TYK2.Rmd")


TYK2_prot <- read_exposure_data("data/export/TYK2_prot_anno_TwoSampleMR.csv", sep=",")
TYK2_T1D  <- read_outcome_data("data/export/TYK2_T1D_TwoSampleMR.csv", sep=",")

TYK2 <- harmonise_data(TYK2_prot, TYK2_T1D)

```

## Manhattan plots

There are no GWAS hits in TYK2 levels in serum. Thus, coloc and MR is not done.

```{r, echo = FALSE}
#create Manhattan plots with vertical lines indicating the selected area (see below 2.4)
TYK2_prot.fig <-
  TYK2 %>%
  ggplot(aes(x = pos.exposure/1000, y=-log10(pval.exposure))) +
  geom_point()+
  geom_hline(yintercept=8, linetype="dashed")+
  # geom_vline(xintercept=36.9e6/1000, linetype="dashed")+
  # geom_vline(xintercept=37.3e6/1000, linetype="dashed")+
  ggtitle("GWAS of TYK2 in serum") +
  ylab("-log10(p)") +
  xlab(NULL)

TYK2_T1D.fig <-
  TYK2 %>%
  ggplot()+
  geom_point(mapping=aes(x = pos.exposure/1000, y=-log10(pval.outcome))) +
  geom_hline(yintercept=8, linetype="dashed")+
  # geom_vline(xintercept=36.9e6/1000, linetype="dashed")+
  # geom_vline(xintercept=37.3e6/1000, linetype="dashed")+
  ggtitle("GWAS of risk of T1D") +
  ylab("-log10(p)") +
  xlab("position(kbp)")

#Obtain range for figure of gene
layer_scales(TYK2_T1D.fig)$x$range$range

TYK2_gene.fig <-
  ggplot(data = TYK2) +
  geom_blank() +
  geom_segment(x=37521.878, xend=37571.094, y=1, yend=1, linewidth = 2) +
  annotate("text", label = "TYK2",
           x= (37521.878 + 37571.094) / 2, y=1, hjust = 0.5, vjust = -1) +
  xlim(36521.878, 38571.094) +
  ylim(0.75, 2) +
  ylab(NULL) + xlab(NULL) +
  theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank())

fig_TYK2_manhattan <- ggarrange(TYK2_gene.fig, TYK2_prot.fig, TYK2_T1D.fig,
                                 heights = c(1, 3, 3), nrow = 3,
                                 ncol = 1, align = "hv")

fig_TYK2_manhattan
# ggsave("figures/TYK2-manhattan-combined-fig.pdf",
#        height = 6, width = 8, units = "in")
```


