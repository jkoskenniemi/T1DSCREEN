---
title: "IL12B"
author: "Tea Heikkil√§, Emilia Kaiser & Jaakko Koskenniemi"
output: html_document
date: '2022-24-04'
editor_options:
  chunk_output_type: console
---

Load packages and import data
```{r}
pacman::p_load(tidyverse,data.table, coloc, TwoSampleMR, ggpubr, 
               ieugwasr, rio, here)

source("code/Functions.R")

here::i_am("analyses/IL12B.Rmd")
```

#pQTL

```{r}
IL12B_pqtl <- import_data("data/export/IL12B_prot_anno_TwoSampleMR.csv",
                          "data/export/IL12B_T1D_TwoSampleMR.csv", has_beta = TRUE)

```

## Manhattan plots

No GWAS hits were seen for the risk of T1D so no MR is done.

```{r}
# create Manhattan plots with vertical lines indicating the selected area (see below 2.4)
manhattan_plots(IL12B_pqtl, gene_start = 159314780, gene_end = 159330863, title = "IL12B")
IL12B_pqtl <- IL12B_pqtl %>% filter(pos.outcome > 159000000 & pos.outcome < 159600000) 
manhattan_plots(IL12B_pqtl, gene_start = 159314780, gene_end = 159330863, title = "IL12B")

#ggsave("figures/IL12B_pqtl-manhattan-fig.png",
#       height = 6, width = 6, units = "in")
```


## Coloc

```{r}
coloc_results_IL12B_pqtl <- analyze_coloc_pqtl(IL12B_pqtl)
```

```{r}

load("data/export/IL12B_LDmat.RData")

IL12B_pqtl <- IL12B_pqtl %>% 
  filter(SNP %in% colnames(IL12B))

coloc_results_IL12B_pqtl <- analyze_coloc_pqtl(IL12B_pqtl)

plot_coloc(genechr = 5,
           fig_start =  159000000,
           fig_end =  159600000,
           coloc_results = coloc_results_IL12B_pqtl$coloc_D1D2,
           data = IL12B_pqtl,
           D1 = coloc_results_IL12B_pqtl$D1,
           D2 = coloc_results_IL12B_pqtl$D2,
           LDmat = IL12B)

ggsave(filename = "figures/IL12B.png", height = 8, width = 6)
```




