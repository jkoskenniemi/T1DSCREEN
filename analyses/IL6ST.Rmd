---
title: "IL6ST"
author: "Tea Heikkil√§, Emilia Kaiser & Jaakko Koskenniemi"
output: html_document
date: '2022-24-04'
editor_options:
  chunk_output_type: console
---

  Load packages and import data
```{r}
pacman::p_load(tidyverse, data.table, coloc, TwoSampleMR, ggpubr, 
               ieugwasr, rio, here)
source("code/Functions.R")
here::i_am("analyses/IL6ST.Rmd")
```


```{r}
IL6ST_pqtl <- import_data("data/export/IL6ST_prot_anno_TwoSampleMR.csv",
                          "data/export/IL6ST_T1D_TwoSampleMR.csv", 
                          has_beta=TRUE)
```

## Manhattan plots

No GWAS hits in T1D. MR is not done.
```{r}
manhattan_plots(IL6ST_pqtl, gene_start = 55935095, gene_end = 55995022,
               title = "IL6ST")

IL6ST_pqtl <- IL6ST_pqtl %>% filter(pos.outcome > 55600000 & pos.outcome < 56200000) 
manhattan_plots(IL6ST_pqtl, gene_start = 55935095, gene_end = 55995022,
               title = "IL6ST")

```


## Coloc

```{r}
coloc_results_IL6ST_pqtl <- analyze_coloc_pqtl(IL6ST_pqtl)
coloc_results_IL6ST_pqtl$coloc_D1D2

```


```{r}

load("data/export/IL6ST_LDmat.RData")

plot_coloc(genechr = 5,
           fig_start = 55600000,
           fig_end = 56200000,
           coloc_results = coloc_results_IL6ST_pqtl$coloc_D1D2,
           data = IL6ST_pqtl,
           D1 = coloc_results_IL6ST_pqtl$D1,
           D2 = coloc_results_IL6ST_pqtl$D2,
           LDmat = IL6ST)

ggsave(filename = "figures/IL6ST.png", height = 8, width = 6)
```


## Functional variants

```{r}
load("data/export/phenoscanner-functional-variants-rsids.RDS")

IL6ST_pqtl_orig <- read_csv("data/export/IL6ST_prot_anno_TwoSampleMR.csv")
IL6ST_pqtl_orig %>%
  filter(SNP %in% filter(functional_variants, gene == "IL6ST")$rsid) %>%
  filter(minus_log10_pval > 5) %>%
  select(SNP, beta, minus_log10_pval, eaf)

library(TwoSampleMR)
IL6ST_pqtl %>%
  filter(SNP == "rs141500365")  %>%
  mr()



IL6ST_pqtl_orig <- read_csv("data/export/IL6ST_prot_anno_TwoSampleMR.csv")
IL6ST_pqtl_orig %>% 
  filter()

```




